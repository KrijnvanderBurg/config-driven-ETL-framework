{
    "job": {
        "extracts": [
            {
                "data_format": "csv",
                "location": "examples/customer_orders/customers.csv",
                "method": "batch",
                "name": "extract-customers",
                "options": {
                    "delimiter": ",",
                    "header": true,
                    "inferSchema": false
                },
                "schema": "examples/customer_orders/customers_schema.json"
            },
            {
                "data_format": "json",
                "location": "examples/customer_orders/orders.json",
                "method": "batch",
                "name": "extract-orders",
                "options": {},
                "schema": "examples/customer_orders/orders_schema.json"
            }
        ],
        "transforms": [
            {
                "name": "transform-join-orders",
                "upstream_name": "extract-customers",
                "functions": [
                    { "function": "customers_orders", "arguments": {"amount_minimum": 100} },
                    { "function": "select", "arguments": {"columns": ["name", "email", "signup_date", "order_id", "order_date", "amount"]} }
                ]
            }
        ],
        "loads": [
            {
                "name": "load-customer-orders",
                "upstream_name": "transform-join-orders",
                "data_format": "csv",
                "location": "examples/customer_orders/output",
                "method": "batch",
                "mode": "overwrite",
                "options": {
                    "header": true
                }
            }
        ]
    },
    "alert": {
        "channels": [
            {
                "type": "email",
                "name": "custom-email-alert-name",
                "config": {
                    "smtp_server": "smtp.company.com",
                    "smtp_port": 587,
                    "username": "username",
                    "password": "password",
                    "from_email": "etl-alerts@company.com",
                    "to_emails": [
                        "ops@company.com",
                        "data-team@company.com"
                    ]
                }
            },
            {
                "type": "http",
                "name": "a-http-post-alert-name",
                "config": {
                    "url": "https://hooks.slack.com",
                    "method": "POST",
                    "headers": {
                        "Content-Type": "application/json"
                    },
                    "timeout": 30,
                    "retry": {
                        "error_on_alert_failure": true,
                        "attempts": 3,
                        "delay_in_seconds": 30
                    }
                }
            },
            {
                "type": "file",
                "name": "custom-file-alert-name",
                "config": {
                    "file_path": "alerts.log"
                }
            }
        ],
        "triggers": [
            {
                "name": "production_critical_errors",
                "enabled": true,
                "channel_names": ["custom-email-alert-name", "a-http-post-alert-name"],
                "templates": {
                    "prepend_title": "ETL Pipeline Alert",
                    "append_title": "Alert Notification",
                    "prepend_body": "Attention: ETL Pipeline Alert",
                    "append_body": "Please take necessary actions."
                },
                "conditions": {
                    "exception_contains": ["database", "connection", "timeout"],
                    "exception_regex": "",
                    "env_vars_matches": {
                        "ENVIRONMENT": ["production", "prod"],
                        "DEPLOYMENT_STAGE": ["live", "production"]
                    }
                }
            },
            {
                "name": "staging_warnings",
                "enabled": true,
                "channel_names": ["custom-file-alert-name"],
                "templates": {
                    "prepend_title": "ETL Pipeline Alert",
                    "append_title": "Alert Notification",
                    "prepend_body": "Attention: ETL Pipeline Alert",
                    "append_body": "Please take necessary actions."
                },
                "conditions": {
                    "exception_contains": [],
                    "exception_regex": ".*connection.*failed.*|.*timeout.*error.*",
                    "env_vars_matches": {
                        "ENVIRONMENT": ["staging", "test"],
                        "APP_MODE": ["debug"]
                    }
                }
            },
            {
                "name": "team_specific_alerts",
                "enabled": true,
                "channel_names": ["a-http-post-alert-name"],
                "templates": {
                    "prepend_title": "ETL Pipeline Alert",
                    "append_title": "Alert Notification",
                    "prepend_body": "Attention: ETL Pipeline Alert",
                    "append_body": "Please take necessary actions."
                },
                "conditions": {
                    "exception_contains": ["database", "connection", "timeout"],
                    "exception_regex": "",
                    "env_vars_matches": {}
                }
            }
        ]
    }
}
